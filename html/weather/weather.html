<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>天气查询</title>
	<link rel="stylesheet" href="https://xjak.github.io/html/weather/css/hzw-city.css">
</head>
<body>
<div class="main">
    <h3>请选择要查询的城市</h3>
    <i>注:仅支持大部分城市</i>
    <input type="text" id="cityChoice" value="请选择">
    <button id="lookup">查询</button>
  <div class="header">
    <ul>
        <li>今天：<span id="show0"></span></li>
    	<li>当前：<span id="Result"></span></li>
       	<li>风向：<span id="show1"></span></li>
    	<li>风力：<span id="show2"></span></li>
    	<li>最高：<span id="show3"></span></li>
    	<li>最低：<span id="show5"></span></li>
    	<li>预计：<span id="show4"></span></li>    	
    	<li>指数：<span id="show"></span></li>
    </ul>
    <h4>未来天气</h4>
    <ul class="uls">
        <li><span id="show11"></span></li>
       	<li>风向：<span id="show12"></span></li>
    	<li>风力：<span id="show13"></span></li>
    	<li>最高：<span id="show14"></span></li>
    	<li>最低：<span id="show15"></span></li>
    	<li>预计：<span id="show16"></span></li>    	
    </ul>
    <ul class="uls">
        <li><span id="show21"></span></li>
       	<li>风向：<span id="show22"></span></li>
    	<li>风力：<span id="show23"></span></li>
    	<li>最高：<span id="show24"></span></li>
    	<li>最低：<span id="show25"></span></li>
    	<li>预计：<span id="show26"></span></li>    	
    </ul>
    <ul class="uls">
        <li><span id="show31"></span></li>
       	<li>风向：<span id="show32"></span></li>
    	<li>风力：<span id="show33"></span></li>
    	<li>最高：<span id="show34"></span></li>
    	<li>最低：<span id="show35"></span></li>
    	<li>预计：<span id="show36"></span></li>    	
    </ul>
    <ul class="uls">
        <li><span id="show41"></span></li>
       	<li>风向：<span id="show42"></span></li>
    	<li>风力：<span id="show43"></span></li>
    	<li>最高：<span id="show44"></span></li>
    	<li>最低：<span id="show45"></span></li>
    	<li>预计：<span id="show46"></span></li>    	
    </ul>
  </div>
</div>
<script src="https://apps.bdimg.com/libs/jquery/2.1.1/jquery.js"></script>
<script src="https://xjak.github.io/html/weather/js/json.js"></script>
<script src="https://xjak.github.io/html/weather/js/hzw-city-picker.min.js"></script>
<script>
	 var  str;
  var cityPicker = new HzwCityPicker({
        data: data,
        target: 'cityChoice',
        valType: 'k-v',
        hideCityInput: {
            name: 'city',
            id: 'city',
            val:'2'
        },
        callback: function(){
        	  str = $('#cityChoice').val();
         	  str = str.replace(/市/g,'');    
        }
    });
    cityPicker.init();
	
   $(function(){ 
  $('#lookup').click(function(){ 
              	if ($('#cityChoice').val()=='请选择') {alert('请选择要查询的城市！');  return} 
                $.ajax({
                  //  async:false,
                    url: '//wthrcdn.etouch.cn/weather_mini?city='+str,
                    type: "GET",
                    dataType: 'jsonp', 
                    timeout: 5000,
                beforeSend: LoadFunction, //加载执行方法    
                error: erryFunction,  //错误执行方法    
                success: succFunction //成功执行方法    
            })  
            function LoadFunction() {  
   
            }  
            function erryFunction() {  
                alert("服务器繁忙，请稍后查询！");  
            }  
            function succFunction(t) { 
            	$('.header').css('display','block');
                $('#cx').text(t.data.city);
              $('#Result').text(t.data.wendu+'℃'); 
              $('#show').text(t.data.ganmao);  
              $('#show1').text(t.data.forecast[0].fengxiang); 
              $('#show2').text(t.data.forecast[0].fengli);
              $('#show3').text(t.data.forecast[0].high);
              $('#show4').text(t.data.forecast[0].type);
              $('#show5').text(t.data.forecast[0].low);
              $('#show0').text(t.data.forecast[0].date);
              for (var i = 1; i < 5; i++) {
              	 $('#show'+i+'1').text(t.data.forecast[i].date);
                 $('#show'+i+'2').text(t.data.forecast[i].fengxiang); 
                 $('#show'+i+'3').text(t.data.forecast[i].fengli);
                 $('#show'+i+'4').text(t.data.forecast[i].high);
                 $('#show'+i+'5').text(t.data.forecast[i].low);
                 $('#show'+i+'6').text(t.data.forecast[i].type);
              }
           }
});
 });
</script>	
</body>
</html>
